{"title":"Visualising Likert Scale Data with Divergining Stacked Bar Chart","markdown":{"yaml":{"title":"Visualising Likert Scale Data with Divergining Stacked Bar Chart","date":"12/4/2023","date-modified":"`r Sys.Date()`","format":"html","execute":{"echo":true,"eval":true,"warning":false}},"headingText":"Overview","containsRefs":false,"markdown":"\n\n\nDeveloped in 1932 by Rensis Likert to measure attitudes, the typical Likert scale is a 5- or 7-point ordinal scale used by respondents to rate the degree to which they agree or disagree with a statement (table). In an ordinal scale, responses can be rated or ranked, but the distance between responses is not measurable. Thus, the differences between \"always,\" \"often,\" and \"sometimes\" on a frequency response Likert scale are not necessarily equal. In other words, one cannot assume that the difference between responses is equidistant even though the numbers assigned to those responses are.\n\nDiverging stacked bar charts are often the best choice when visualizing Likert scale data. There are various ways to produce these graphs, there are:\n\n-   **likert** package,\n-   *likert* function of **HH** package, and\n-   *plot_liker* function of **sjPlot** package\n\nIn this hands-on exercise, we will focus on using *likert* function of [**HH**]() package.\n\n## Data Preparation\n\n### Installing and launching R packages\n\nFor this exercise, the HH R package will be used. You are also need to ensure that the tidyverse family packages also used install.\n\nThe code chunks below will accomplish the task.\n\n```{r}\npacman::p_load(HH, tidyverse)\n```\n\n### Importing Data\n\nFirst, important the data into R by using the code below.\n\n```{r}\nraw <- read_csv(\"chap04/data/SurveyData.csv\")\n```\n\nNotice that all the variables are categorical data type.\n\n## Data Preparation\n\n### Making the table long\n\nThe data has responses for different questions in columns. The questions data in columns are gathered into rows with the **tidyr**'s *gather* function\n\n```{r}\nsurvey <- gather(raw, measure, response, c(5:12))\n```\n\n### Converting to factor\n\nThe measure and response columns are recoded as factors.\n\n```{r}\nsurvey$measure <- as.factor(survey$measure)\nsurvey$response <- as.factor(survey$response)\n```\n\n### It is about time\n\nThe data is filtered by Month using the *filter* function from **dplyr**.\n\n```{r}\nOct <- filter(survey, Month==\"Oct\")\nNov <- filter(survey, Month==\"Nov\")\n```\n\n### Creating the contingency table\n\nThe data is tabulated into a contingency table by measure and response (satisfaction rating)\n\n```{r}\nOct_df <- table(Oct$measure,Oct$response) %>%\n  as.data.frame.matrix()\n\nNov_df <- table(Nov$measure,Nov$response) %>% \n  as.data.frame.matrix()\n```\n\n### Changing the column name\n\nThe column names are changed to reflect the satisfaction rating (Very Poor, Poor, Satisfactory, Good, Excellent) instead of the number scale( 1,2,3,4,5). The number \"0\" is recoded as \"Missing\". The row names are changed to the actual 8 questions instead of using the names Measure 1 to Measure 8\n\n```{r}\ncolnames(Oct_df) <- c(\"No_Resp\",\"Very Poor\",\"Poor\",\"Satisfactory\",\"Good\",\"Excellent\")\n\nrownames(Oct_df)<-c(\"Temperature of Food\",\n                    \"Timeliness of Meals Served\",\n                    \"Accuracy of Meals Served\",\n                    \"Courtesy of Food Service Staff\",\n                    \"Portion Size of Meals Served\",\n                    \"Taste of Meals Served\",\n                    \"Variety of Food Provided in Menu\",\n                    \"Presentation of Meals Served\")\n\ncolnames(Nov_df) <- c(\"No_Resp\",\"Very Poor\",\"Poor\",\"Satisfactory\",\"Good\",\"Excellent\")\n\nrownames(Nov_df) <- c(\"Temperature of Food\",\n                      \"Timeliness of Meals Served\",\n                      \"Accuracy of Meals Served\",\n                      \"Courtesy of Food Service Staff\",\n                      \"Portion Size of Meals Served\",\n                      \"Taste of Meals Served\",\n                      \"Variety of Food Provided in Menu\",\n                      \"Presentation of Meals Served\")\n```\n\n### Changing the dataframe row name\n\nThe R dataframe row names are converted into a column called Measure for better usage\n\n```{r}\nOct_df <- tibble::rownames_to_column(Oct_df, \n                                     var=\"Measure\") \nNov_df <- tibble::rownames_to_column(Nov_df, \n                                     var=\"Measure\") \n```\n\n### Excluding missing value\n\nThe column \"Missing\" is removed as we do not want to plot it as it would distort the chart.\n\n```{r}\nOct_df <- Oct_df[,c(1,3:7)]\nNov_df <- Nov_df[,c(1,3:7)]\n```\n\n## Working with *likert* function of **HH** Package\n\nThe survey results are presented using stacked divergent barcharts using the *likert* function from the **HH** library in R.\n\n### The basic diverging stacked bar chart\n\nBelow are the code chunk used to create the basic diverging stacked bar charts for the month of October of 2016.\n\n::: panel-tabset\n## The plot\n\n```{r}\n#| echo: false\nlikert(Measure ~ ., \n       data=Oct_df, \n       ylab=NULL,\n       ReferenceZero=3, \n       as.percent=TRUE,\n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Oct 2016\",x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",\n                 x=unit(.57, \"npc\")),\n       xlim=c(-40,-20,0,20,40,60,80,100),\n       strip=FALSE, \n       par.strip.text=list(cex=.7))\n```\n\n## The code chunk\n\n```{r}\n#| eval: false\nlikert(Measure ~ ., \n       data=Oct_df, \n       ylab=NULL,\n       ReferenceZero=3, \n       as.percent=TRUE,\n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Oct 2016\",x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",\n                 x=unit(.57, \"npc\")),\n       xlim=c(-40,-20,0,20,40,60,80,100),\n       strip=FALSE, \n       par.strip.text=list(cex=.7))\n```\n:::\n\n::: callout-note\n### Things to learn from the code chunk above\n\n-   The results are displayed as percentages using the as.percent=TRUE option.\n-   The results are sorted by descending order using the positive.order=TRUE option.\n-   The x-axis tick marks separtion is set to 20. Since we are using a divergent chart we have to define negative values as well.\n-   The unit function is used to define the position of the main title and subtitle to ensure they are centered.\n-   The count of responses for each question is displayed with tick marks.\n:::\n\n*DIY: Plot a diverging bar chart for the month of November 2016.*\n\nThe output should look similar to the figure below:\n\n::: panel-tabset\n## The plot\n\n```{r}\n#| echo: false\nlikert(Measure ~ ., data=Nov_df, ylab=NULL,\n       ReferenceZero=3, as.percent=TRUE,\n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Nov 2016\",x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       strip=FALSE,\n       par.strip.text=list(cex=.7))\n```\n\n## The code chunk\n\n```{r}\n#| eval: false\nlikert(Measure ~ ., \n       data=Nov_df, \n       ylab=NULL,\n       ReferenceZero=3, \n       as.percent=TRUE,\n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Nov 2016\",\n                   x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",\n                 x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       strip=FALSE,\n       par.strip.text=list(cex=.7))\n```\n:::\n\n### Diverging Stacked Bar Charts with Two Categories\n\nWe try out the option of splitting the questions into Meal and Services categories.\n\n::: panel-tabset\n## The plot\n\n```{r}\n#| echo: false\nType <-c(\"Meal\", \"Service\", \"Service\",\"Service\",\n         \"Meal\",\"Meal\",\"Meal\",\"Meal\")\nOct_df2<-cbind(Oct_df,Type)\nNov_df2<-cbind(Nov_df,Type)\n\nlikert(Measure ~ .| Type, \n       data=Oct_df2,\n       layout=c(1,2),\n       scales=list(y=list(relation=\"free\")),\n       between=list(y=1),\n       strip.left=strip.custom(bg=\"gray97\"),\n       strip=FALSE,\n       par.strip.text=list(cex=1.1, lines=2),\n       ylab=NULL, \n       cex=1.2,\n       ReferenceZero=3,\n       as.percent=TRUE, \n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Oct 2016\",\n                   x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       resize.height.tuning=1)\n```\n\n## The code chunk\n\n```{r}\n#| eval: false\nType <-c(\"Meal\", \"Service\", \"Service\",\"Service\",\n         \"Meal\",\"Meal\",\"Meal\",\"Meal\")\nOct_df2<-cbind(Oct_df,Type)\nNov_df2<-cbind(Nov_df,Type)\n\nlikert(Measure ~ .| Type, \n       data=Oct_df2,\n       layout=c(1,2),\n       scales=list(y=list(relation=\"free\")),\n       between=list(y=1),\n       strip.left=strip.custom(bg=\"gray97\"),\n       strip=FALSE,\n       par.strip.text=list(cex=1.1, lines=2),\n       ylab=NULL, \n       cex=1.2,\n       ReferenceZero=3,\n       as.percent=TRUE, \n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Oct 2016\",\n                   x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\",x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       resize.height.tuning=1)\n```\n:::\n\n*DIY: Plot a diverging bar chart with two categories for the month of November 2016.*\n\n::: panel-tabset\n## The plot\n\nThe output should look similar to the figure below:\n\n```{r}\n#| echo: false\nlikert(Measure ~ .| Type, data=Nov_df2,\n       layout=c(1,2),\n       scales=list(y=list(relation=\"free\")),\n       between=list(y=1),\n       strip.left=strip.custom(bg=\"gray97\"),\n       strip=FALSE,\n       par.strip.text=list(cex=1.1, lines=2),\n       ylab=NULL, \n       cex=1.2,\n       ReferenceZero=3,\n       as.percent=TRUE, \n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Nov 2016\", x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\", x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       resize.height.tuning=1)\n```\n\n## The code chunk\n\nThe code chunk should look similar to the print below:\n\n```{r}\n#| eval: false\nlikert(Measure ~ .| Type, data=Nov_df2,\n       layout=c(1,2),\n       scales=list(y=list(relation=\"free\")),\n       between=list(y=1),\n       strip.left=strip.custom(bg=\"gray97\"),\n       strip=FALSE,\n       par.strip.text=list(cex=1.1, lines=2),\n       ylab=NULL, \n       cex=1.2,\n       ReferenceZero=3,\n       as.percent=TRUE, \n       positive.order=TRUE, \n       main = list(\"Monthly Meal Service Satisfaction Survey Report, Nov 2016\", \n                   x=unit(.55, \"npc\")), \n       sub= list(\"Satisfaction Rating\", x=unit(.57, \"npc\")), \n       xlim=c(-40,-20,0,20,40,60,80,100),\n       resize.height.tuning=1)\n```\n:::\n\n**Credit:** This hands-on exercise was created base on DataViz Makeover 3 submission by David Ten Kao Yuan (ISSS608 AY2016-17T3).\n\n```{r}\n#| eval: false\n#| echo: false\nrenderthis::to_pdf(from = \"https://r4va.netlify.app/chap05.html\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"chap05.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.475","bibliography":["references.bib"],"editor":"visual","theme":"cosmo","title":"Visualising Likert Scale Data with Divergining Stacked Bar Chart","date":"12/4/2023","date-modified":"`r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"chap05.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt","title":"Visualising Likert Scale Data with Divergining Stacked Bar Chart","date":"12/4/2023","date-modified":"`r Sys.Date()`"},"extensions":{"book":{}}}}}